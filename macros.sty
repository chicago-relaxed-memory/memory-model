\newcommand{\F}{\mathsf{F}}
\newcommand{\hoare}[3]{\{#1\}\;#2\;\{#3\}}
\newcommand{\fwp}{\textit{wp}}

\newcommand{\xinit}{\mathsf{init}}
\newcommand{\BNFSEP}{\ensuremath{\;\mathrel{|}\;}}
\newcommand{\BNFDEF}{\ensuremath{\;\mathrel{\mathord{\vcentcolon}\mkern-1mu\mathord{\vcentcolon}\mathord{{=}}}\;}}

\newcommand{\restrict}[1]{\mathbin{|}_{#1}}
\newcommand{\textand}{\;\allowbreak\text{and}\allowbreak\;}
\newcommand{\textimplies}{\; \allowbreak\text{implies}\allowbreak\;}
\newcommand{\textor}{\; \allowbreak\text{or}\allowbreak\;}

\newcommand{\fpox}{\mathit{po}}
\newcommand{\fird}{\mathit{ird}}
\newcommand{\TIKZ}[2][]{\left\{\,\begin{tikzpicture}[baselinecenter,node distance=1em,#1]#2\end{tikzpicture}\,\right\}}
\newcommand{\fork}{\setminus_{\mathsf{S}}}

\newcommand{\refapp}[1]{Appendix~\ref{app:#1}}

\newenvironment{noenv}{\ignorespaces}{\ignorespacesafterend}
\newcommand{\aCmd}{C}
\newcommand{\bCmd}{D}
\newcommand{\eCmd}{E}

\newcommand{\ifnotempty}[2]{\ifx\relax#1\relax\else#2\fi}
\newcommand{\ifnotemptyelse}[3]{\ifx\relax#1\relax#3\else#2\fi}
\newcommand{\ifemptyelse}[3]{\ifx\relax#1\relax#2\else#3\fi}

\newcommand{\dontcare}{\texttt{\_}}
\newcommand{\pair}[2]{\langle#1,\,#2\rangle}
\newcommand{\freads}{\mathsf{reads}}
\newcommand{\fwrites}{\mathsf{writes}}
\newcommand{\rreads}{\mathsf{Rd}}
\newcommand{\rwrites}{\mathsf{Wr}}

\newcommand{\Sub}{\mathcal{S}}
\newcommand{\aSub}{\sigma}
\newcommand{\bSub}{\rho}

\newcommand{\Reg}{\mathcal{R}}
\newcommand{\aReg}{r}
\newcommand{\bReg}{s}

\newcommand{\LR}{\mathcal{L}}
\newcommand{\aLR}{\ell}

\newcommand{\Loc}{\mathcal{X}}
\newcommand{\aLoc}{x}
\newcommand{\bLoc}{y}
\newcommand{\cLoc}{z}

\newcommand{\LVal}{\mathcal{L}}
\newcommand{\aLV}{\ell}
\newcommand{\bLV}{k}

\newcommand{\Val}{\mathcal{V}}
\newcommand{\aVal}{v}
\newcommand{\bVal}{w}

\newcommand{\Exp}{\mathcal{E}}
\newcommand{\aExp}{M}
\newcommand{\bExp}{N}
\newcommand{\aEExp}{\mathbb{M}}
\newcommand{\bEExp}{\mathbb{N}}

\newcommand{\Formulae}{\Phi}
\newcommand{\aForm}{\phi}
\newcommand{\bForm}{\psi}
\newcommand{\cForm}{\chi}
\newcommand{\dForm}{\xi}
\newcommand{\TRUE}{\mathsf{true}}
\newcommand{\FALSE}{\mathsf{false}}

\newcommand{\Rel}{\mathsf{Rel}}
\newcommand{\Acq}{\mathsf{Acq}}
\newcommand{\Act}{\mathcal{A}}
\newcommand{\aActSub}{\alpha}
\newcommand{\bActSub}{\beta}

\newcommand{\aAct}{a}
\newcommand{\bAct}{b}
\newcommand{\cAct}{c}
\newcommand{\dAct}{d}
\newcommand{\DRAcq}[2]{\mathsf{R_A}\ifnotempty{#1}{\,#1\,#2}}
\newcommand{\DWRel}[2]{\mathsf{W_R}\ifnotempty{#1}{\,#1\,#2}}
% \newcommand{\DRAcq}[2]{\mathsf{R_{acq}}\ifnotempty{#1}{\,#1\,#2}}
% \newcommand{\DWRel}[2]{\mathsf{W_{rel}}\ifnotempty{#1}{\,#1\,#2}}
\newcommand{\DR}[2]{\mathsf{R}\ifnotempty{#1}{\,#1\,#2}}
\newcommand{\DW}[2]{\mathsf{W}\ifnotempty{#1}{\,#1\,#2}}
\newcommand{\DT}[1]{\mathsf{T}\ifnotempty{#1}{\,#1}}
\newcommand{\DSB}{\mathsf{SB}}
\newcommand{\DF}{\mathsf{FF}}
\newcommand{\DB}[1]{\mathsf{B}\ifnotempty{#1}{\,#1}}
\newcommand{\DC}[1]{\mathsf{C}\ifnotempty{#1}{\,#1}}

\newcommand{\EAct}{A}
\newcommand{\ESub}{S}
\newcommand{\Event}{E}
\newcommand{\aEv}{e}
\newcommand{\bEv}{d}
\newcommand{\cEv}{c}
\newcommand{\cEvs}{C}
\newcommand{\begEv}{b}
\newcommand{\comEv}{c}
\newcommand{\ltN}{\mathrel{\,\mid\!\!\!<}}
\newcommand{\gtN}{\mathrel{\mkern4mu\mid\!\!\!>}}

\newcommand{\Alphabet}{\Sigma}
\newcommand{\labelling}{\lambda}
\newcommand{\labellingForm}{\lambda_{\Formulae}}
\newcommand{\labellingAct}{\lambda_{\Act}}

\newcommand{\RF}{\mathsf{RF}}

\newcommand{\NEVER}[1]{\rlap{$\times$}#1}

\newcommand{\partialfun}{\mathbin\rightharpoonup}
\newcommand{\fun}{\mathbin\rightarrow}
\newcommand{\prefix}{\mathbin\rightarrow}
\newcommand{\sequence}{\mathbin;}
\newcommand{\guard}{\mathbin\rhd}
\newcommand{\st}{\mathbin.}

\newcommand{\aPS}{P}
\newcommand{\aPSS}{\mathcal{P}}

\newcommand{\sem}[1]{\llbracket#1\rrbracket}
\newcommand{\semsc}[1]{\llbracket#1\rrbracket_{\textit{SC}}}
%\newcommand{\semsc}[1]{\textit{SC}\llbracket#1\rrbracket}
\newcommand{\REL}{\mathsf{rel}\,}
\newcommand{\ACQ}{\mathsf{acq}\,}
\newcommand{\FENCE}{\texttt{fullFence}}
\newcommand{\BEGIN}{\texttt{begin}}
\newcommand{\COMMIT}{\texttt{commit}}
\newcommand{\RECOVERY}{\texttt{onabort}\,\{}
\newcommand{\ENDREC}{\,\}}
\newcommand{\BEGINVAL}{\BEGIN\,\aVal}
\newcommand{\COMMITVAL}{\COMMIT\,\aVal}
\newcommand{\RECOVERYVAL}{\texttt{onabort}\,\aVal\,\{\,}
\newcommand{\END}{\texttt{end}}
\newcommand{\SKIP}{\texttt{skip}}
\newcommand{\GETS}{\texttt{:}\mkern-1mu\texttt{=}\,}
\newcommand{\SEQ}{\texttt{;}\,}
\newcommand{\SEMI}{\texttt{;}\,}
\newcommand{\IF}{\texttt{if}\,}
\newcommand{\PASS}{\texttt{pass}}
\newcommand{\WHILE}{\texttt{while}\,}
\newcommand{\DO}[1]{\texttt{do}\,\{#1\}\,}
\newcommand{\THEN}{\,\{\,}
\newcommand{\ELSE}{\,\}\,\texttt{else}\,\{\,}
\newcommand{\ELIF}{\,\}\,\texttt{else}\,\texttt{if}\,}
\newcommand{\brELSE}{\,\}\\\texttt{else}\,\{\,}
\newcommand{\brELIF}{\,\}\\\texttt{else}\,\texttt{if}\,}
\newcommand{\FI}{\,\}}
\newcommand{\PAR}{\,\mathbin{\|}\,}
\newcommand{\VAR}{\texttt{var}\,}
\newcommand{\TOUCHED}{\texttt{touched}\,}

\newcommand{\CANREAD}{\texttt{canRead}}
\newcommand{\SEC}{\texttt{SECRET}}
\newcommand{\RETURN}{\texttt{return}\,}
\newcommand{\BARRIER}{\texttt{barrier}}

\newcommand{\EQ}{\,\texttt{=}\,}
\newcommand{\NOTEQ}{\,\texttt{!=}\,}

\newcommand{\GCC}{\texttt{gcc}}
\newcommand{\CLANG}{\texttt{clang}}

\usepackage[T1]{fontenc}
\usepackage{alltt}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{hyperref}
\usepackage{makecell}
\usepackage{mathtools}
\usepackage{stmaryrd}
\usepackage{verbatim}

\theoremstyle{acmdefinition}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\usepackage{tikz}
\usetikzlibrary{shapes}
\usetikzlibrary{shapes.misc}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{topaths}
\usetikzlibrary{arrows}
\usetikzlibrary{positioning}
\usetikzlibrary{matrix}
\usetikzlibrary{fit}
\usetikzlibrary{calc}

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}

\pgfsetlayers{background,main,foreground}

%\tikzset{baselinecenter/.style= {baseline=([yshift=-1ex]current bounding box.west)} }
\tikzstyle{baselinecenter} = [baseline={([yshift=-.5ex]current bounding box.west)}]
%\tikzstyle{baselinecenter} = [baseline=(current bounding box.west)]
\tikzstyle{event} = [draw=black, fill=blue!10, rectangle, rounded corners, minimum size=3ex]
\newcommand{\event}[3]{\node[event](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{cloudy} = [draw=black, fill=blue!10, cloud, aspect=2]
\newcommand{\cloud}[3]{\node[cloudy](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{final} = [draw=black, fill=blue!10, rectangle, rounded corners, double, minimum size=3ex]
\newcommand{\final}[3]{\node[final](#1)[#3]{$\mathstrut#2$};}
\tikzset{nonevent/.style={
        event, 
        append after command={
            node [
                fit=(\tikzlastnode),
                draw=red!50!black,
                thick,
                inner sep=-2\pgflinewidth,
                cross out
            ] {}
        }
    }
}
\newcommand{\nonevent}[3]{\node[nonevent](#1)[#3]{$\mathstrut#2$};}
\tikzstyle{race} = [-,thick,decorate,decoration={zigzag,segment length = 0.2cm, amplitude = 0.5mm},color=orange!90!black]
\newcommand{\race}[3][]{\begin{pgfonlayer}{background}\draw[race,#1](#2) to (#3);\end{pgfonlayer}}

\tikzstyle{po} = [->]
\newcommand{\po}[3][]{\draw[po,#1](#2)to(#3);}
\tikzstyle{lift} = [->,double]
\newcommand{\lift}[3][]{\draw[lift,#1](#2)to(#3);}
\tikzstyle{rf} = [->,thick,color=black!50!red]
\newcommand{\rf}[3][]{\draw[rf,#1](#2)to(#3);}
\newcommand{\rrf}{\ensuremath{\mathrel{\mathsf{rf}}}}%
\newcommand{\xrf}{\xarrowtikz{rf}{rf}}%
\newcommand{\rfx}[4][]{\draw[rf,#1](#2) edge node[above,text=black!50!green]{$#3$} (#4);}
\tikzstyle{wk} = [->,dashed]
\newcommand{\wk}[3][]{\draw[wk,#1](#2)to(#3);}

\usepackage{xparse}
\tikzstyle{hb} = [->,thick]
\NewDocumentCommand \hb {O{} m O{} m} {\draw[hb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{hb}$}  (#4);}
\newcommand{\rhb}{\ensuremath{\mathrel{\mathsf{hb}}}}%
\newcommand{\xhb}{\xarrowtikz{hb}{hb}}%
\tikzstyle{sw} = [->,thick]
\NewDocumentCommand \sw {O{} m O{} m} {\draw[sw,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{sw}$}  (#4);}
\newcommand{\rsw}{\ensuremath{\mathrel{\mathsf{sw}}}}%
\newcommand{\xsw}{\xarrowtikz{sw}{sw}}%
\tikzstyle{ird} = [->,thick,color=black!50!green]
\NewDocumentCommand \ird {O{} m O{} m} {\draw[ird,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{ird}$}  (#4);}
\newcommand{\rird}{\ensuremath{\mathrel{\mathsf{ird}}}}%
\newcommand{\xird}{\xarrowtikz{ird}{ird}}%
\tikzstyle{rb} = [->,thick,dotted,color=black!50!green]
\NewDocumentCommand \rb {O{} m O{} m} {\draw[rb,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{rb}$}  (#4);}
\newcommand{\rrb}{\ensuremath{\mathrel{\mathsf{rb}}}}%
\newcommand{\xrb}{\xarrowtikz{rb}{rb}}%
\tikzstyle{pox} = [->,thick,color=blue!50!black]
\NewDocumentCommand \pox {O{} m O{} m} {\draw[pox,#1](#2) to [auto,#3] node {$\scriptstyle\mathsf{po}$}  (#4);}
\newcommand{\rpox}{\ensuremath{\mathrel{\mathsf{po}}}}%
\newcommand{\xpox}{\xarrowtikz{pox}{po}}%

\newsavebox{\mytempbox}
\newcommand{\xarrowtikz}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (0,0) -- node[midway,#1]{\(\scriptstyle\mathsf{#3}\)} (\wd\mytempbox,0);}}}}
\newcommand{\xarrowtikzrev}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (\wd\mytempbox,0) -- node[pos=0.4,#1]{\(\scriptstyle\mathsf{#3}\)} (0,0);}}}}
\newcommand{\xarrowtikzboth}[3][above=-0.45ex]{\sbox{\mytempbox}{\hbox{\( \scriptstyle\mathsf{#3}\mkern17mu \)}}%
  \mathrel{\smash{\tikz[baseline=-0.5ex]{\draw[#2] (0,0) -- node[midway,#1]{\(\scriptstyle\mathsf{#3}\)} (\wd\mytempbox,0);
        \draw[#2] (\wd\mytempbox,0) -- (0,0);
      }}}}

\newcommand{\xarrow}[1]{\xrightarrow{\smash{#1}}}
%\newcommand{\xarrow}[1]{\xrightarrow{\raisebox{-1ex}{$\scriptstyle\smash{#1}$}}}
\newcommand{\Xarrow}[1]{\xRightarrow{#1}}



% Local Variables:
% mode: latex
% TeX-master: "paper"
% End: